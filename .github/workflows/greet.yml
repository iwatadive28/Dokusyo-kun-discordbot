name: Weekly Reading Group Greetings

on:
  schedule:
    # é‡‘æ›œ21:00ï¼ˆJSTï¼‰â†’ é‡‘æ›œ12:00ï¼ˆUTCï¼‰
    - cron: '0 12 * * 5'
    # åœŸæ›œ7:00ï¼ˆJSTï¼‰â†’ é‡‘æ›œ22:00ï¼ˆUTCï¼‰
    - cron: '0 22 * * 5'
    # åœŸæ›œ7:55ï¼ˆJSTï¼‰â†’ é‡‘æ›œ22:55ï¼ˆUTCï¼‰
    - cron: '55 22 * * 5'
  workflow_dispatch:  # æ‰‹å‹•å®Ÿè¡Œã‚‚å¯èƒ½

jobs:
  greet:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¦ ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
        uses: actions/checkout@v3

      - name: ğŸ Python ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: ğŸ“š ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
        run: pip install -r requirements.txt

      - name: ğŸ¤– é‡‘æ›œå¤œã®ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼
        if: github.event.schedule == '0 12 * * 5'
        run: python greet.py day_before
        env:
          DISCORD_BOT_TOKEN: ${{ secrets.DISCORD_BOT_TOKEN }}
          DISCORD_CHANNEL_ID: ${{ secrets.DISCORD_CHANNEL_ID }}

      - name: ğŸŒ èª­æ›¸ä¼šé–‹å§‹ã®ã‚ã„ã•ã¤
        if: github.event.schedule == '0 22 * * 5'
        run: python greet.py start_notice
        env:
          DISCORD_BOT_TOKEN: ${{ secrets.DISCORD_BOT_TOKEN }}
          DISCORD_CHANNEL_ID: ${{ secrets.DISCORD_CHANNEL_ID }}

      - name: â° èª­æ›¸ä¼šçµ‚äº†5åˆ†å‰ã®é€šçŸ¥
        if: github.event.schedule == '55 22 * * 5'
        run: python greet.py end_notice
        env:
          DISCORD_BOT_TOKEN: ${{ secrets.DISCORD_BOT_TOKEN }}
          DISCORD_CHANNEL_ID: ${{ secrets.DISCORD_CHANNEL_ID }}
